<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" type="text/css" href="style.css">
		<script src="/__/firebase/3.9.0/firebase-app.js"></script>
		<script src="/__/firebase/3.9.0/firebase-auth.js"></script>
		<script src="/__/firebase/3.9.0/firebase-database.js"></script>

		<script src="/__/firebase/init.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>

        <script src="js/jquery.bxslider.min.js"></script>
		<script>
			function signOut() {
				firebase.auth().signOut().then(function() {
					// Sign-out successful.
					window.location = "index.html";
				}).catch(function(error) {
						// An error happened.
				});
			}	
			function init() {
				document.getElementById("sign-out").addEventListener("click", signOut, false);
			}
			function initApp() {
		    	// Listening for auth state changes.
		    	// [START authstatelistener]
		    	firebase.auth().onAuthStateChanged(function(user) {
		     		// [START_EXCLUDE silent]
					// document.getElementById('quickstart-verify-email').disabled = true;
					// [END_EXCLUDE]
					if (user) {
						

						// User is signed in.

						var displayName = user.displayName;
						var email = user.email;
						var emailVerified = user.emailVerified;
						var photoURL = user.photoURL;
						var isAnonymous = user.isAnonymous;
						var uid = user.uid;
						var providerData = user.providerData;
						var userRef = firebase.database().ref("Yields/" + uid + "/bounty");
						// [START_EXCLUDE]
						document.getElementById('users-name').textContent = displayName;
                        $('.bxslider').bxSlider({
  							infiniteLoop: false,
  							hideControlOnEnd: true
						});
						
						userRef.on("value", function(snapshot) {
							var value = snapshot.val();
							var keyValues = Object.values(value);
							var keyNames = Object.keys(value);
					
							for (var i in keyNames) {
						   document.getElementById('item' + i).innerHTML = "<p>" + keyNames[i] + ": " + keyValues[i] + "</p>";
						}
						
						}, function (error) {
						   document.getElementById('testcontent').textContent = 'Database Error';
						});

						firebase.database().ref().update(updates["Yields/" + uid + "/bounty/apples"] = "newline!!!");


		          		// [END_EXCLUDE]
		    		} else {
		        		// User is signed out.
		        		// [START_EXCLUDE]
		        		document.getElementById('users-only').style.visibility = 'hidden';
		        		// [END_EXCLUDE]
		        	}
		        	// [START_EXCLUDE silent]
		      		//document.getElementById('quickstart-sign-in').disabled = false;
		        	// [END_EXCLUDE]
		      	});  
		    }
			window.onload=function() {
				init();
				initApp();
			}
		</script>
	</head>
	<body>
	<h1 class="title">Farmer Jack's Tender</h1>
		<div id="users-only" class="main">
			<button id="sign-out">Sign out</button>
				<p>Welcome, <span id="users-name"> </span>!!</p>
             <ul class="bxslider">
 				<li><img src="img_basket/apples.jpg" /></li>
  				<li><img src="img_basket/whitemushrooms.jpg" /></li>  
  				<li><img src="img_basket/tomatoes.jpg" /></li>  
  				<li><img src="img_basket/potatoes.jpg" /></li>
			</ul>
			<div id="item0"></div>
			<div id="item1"></div>
			<div id="item2"></div>
			<div id="item3"></div>
		</div>
	</body>      
</html>